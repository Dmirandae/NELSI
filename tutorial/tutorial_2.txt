
7. Loading a virus data set estimated in BEAST 
-----------------------------------------------

Phylogenetic trees in NEXUS format can have a large number of annotations, with information about rates, times, or other traits for every branch in the tree. These annotationa can be read in R with the pacakge [epibase](http://www.inside-r.org/packages/cran/epibase) and then imported into a tree data matrix to be used with NELSI.

The examples_data folder contains a tree from *ENV* sequences from HIV type A collected between 1991 and 2008. 

- Type the following code to read the tree (remember to set the working directory to the example_data folder):

```{r}
hivTree <- read.annotated.nexus("hiv_A_env.tree")
```

- Plot the tree with the function plot:

```{r}
plot(hivTree)
```

The tree is a chronogram, so that the branch lengths represent units of time. The ages of the nodes can be obtained with the function branching.times, but this only works for ultrametric trees, which is not the case for these data because the samples were obtained at different points in time (heterochronous). The function allnode.times in NELSI can obtain the ages of the nodes and tips for heterochronous trees. The first items of the function are the ages of the tips, and the remaining are the ages of internal nodes.

- Type the following code to plot the tree with out taxon names. Instead add the ages of the tips and internal nodes with tiplabel and nodelabel functions. 

```{r}
plot(hivTree, show.tip.label = F)
tip.ages <- round(allnode.times(hivTree), 2) # Round to two decimal places for a clearer plot
# See the tip ages. The first 19 elements are the ages of the tips (the tree has 19 tips), while the remaining are the ages of internal nodes
tiplabels(tip.ages[1:19])
nodelabels(tip.ages[20:37])
```

The age of the youngest tip is always assigned an age of 0, and the age of the root is taken with reference to the youngest tip.


8. Obtaining the tree data matrix for a tree estimated in BEAST
---------------------------------------------------------------

We will use the tree in 7. to obtain the tree data matrix and plot the rates through time.

- Use the function tann2trdat to convert the HIV tree in 7. to an object of class ratesim:

```{r}
hivRatesim <- trann2trdat(hivTree)
```
